!function(n,o){"object"==typeof exports&&"object"==typeof module?module.exports=o():"function"==typeof define&&define.amd?define("WSR",[],o):"object"==typeof exports?exports.WSR=o():n.WSR=o()}(window,function(){return function(n){var o={};function t(e){if(o[e])return o[e].exports;var i=o[e]={i:e,l:!1,exports:{}};return n[e].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=n,t.c=o,t.d=function(n,o,e){t.o(n,o)||Object.defineProperty(n,o,{enumerable:!0,get:e})},t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,o){if(1&o&&(n=t(n)),8&o)return n;if(4&o&&"object"==typeof n&&n&&n.__esModule)return n;var e=Object.create(null);if(t.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:n}),2&o&&"string"!=typeof n)for(var i in n)t.d(e,i,function(o){return n[o]}.bind(null,i));return e},t.n=function(n){var o=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(o,"a",o),o},t.o=function(n,o){return Object.prototype.hasOwnProperty.call(n,o)},t.p="",t(t.s=0)}([function(n,o,t){"use strict";function e(n){var o=n.msg,t=n.preMsg,e=void 0===t?"websocket：":t,i=n.style,r=n.print;!0===(void 0===r||r)&&console.log("%c".concat(e).concat(o),"".concat(i))}var i;function r(n){var o=n.url,t=n.pingTimeout,e=void 0===t?4e3:t,r=n.pongTimeout,s=void 0===r?6e3:r,p=n.reconnectInterval,u=void 0===p?3e3:p,f=n.pingMsg,l=void 0===f?"Ping!":f,g=n.print,a=void 0===g||g;(i=this).opts={url:o,pingTimeout:e,pongTimeout:s,reconnectInterval:u,pingMsg:l,print:a},this.onopen=function(){},this.onmessage=function(){},this.onclose=function(){},this.onerror=function(){},c()}function c(){i.ws=new WebSocket(i.opts.url),console.group("Websocket"),e({msg:"正在连接...",print:i.opts.print}),i.init()}function s(){clearTimeout(i.pingID),clearTimeout(i.pongID),new Promise(function(n,o){i.pingID=setTimeout(function(){i.ws.send(i.opts.pingMsg),e({msg:"===>> ".concat(i.opts.pingMsg," - 心跳间隔 ").concat(i.opts.pingTimeout,"ms"),print:i.opts.print}),n()},i.opts.pingTimeout)}).then(function(){new Promise(function(n,o){i.pongID=setTimeout(function(){e({msg:"".concat(i.opts.pongTimeout,"ms 未收到响应，等待重连..."),print:i.opts.print}),i.ws.close(),n()},i.opts.pongTimeout)})})}t.r(o),r.prototype.init=function(){i.ws.onopen=function(){e({msg:"已经连接",print:i.opts.print}),i.onopen(),s()},i.ws.onmessage=function(n){e({msg:"<<=== Pong",print:i.opts.print}),i.onmessage(n),s()},i.ws.onerror=function(){i.onerror()},i.ws.onclose=function(){e({msg:"连接已关闭",print:i.opts.print}),console.groupEnd(),i.onclose(),!0!==i.stopConnect&&(clearTimeout(i.connectID),i.connectID=setTimeout(c,i.opts.reconnectInterval))}},r.prototype.send=function(n){i.ws.send(n)},r.prototype.close=function(){i.stopConnect=!0,i.ws.close()},o.default=r}])});